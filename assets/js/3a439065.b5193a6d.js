"use strict";(self.webpackChunksiglens_docs=self.webpackChunksiglens_docs||[]).push([[8104],{839:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>a,default:()=>u,frontMatter:()=>t,metadata:()=>d,toc:()=>o});var s=i(5893),l=i(1151);const t={},a="mvexpand",d={id:"spl-docs/mvexpand-command",title:"mvexpand",description:"Description",source:"@site/docs/spl-docs/mvexpand-command.md",sourceDirName:"spl-docs",slug:"/spl-docs/mvexpand-command",permalink:"/siglens-docs/spl-docs/mvexpand-command",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"makemv",permalink:"/siglens-docs/spl-docs/makemv-command"},next:{title:"rare",permalink:"/siglens-docs/spl-docs/rare-command"}},r={},o=[{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Required arguments",id:"required-arguments",level:2},{value:"field",id:"field",level:3},{value:"Optional arguments",id:"optional-arguments",level:2},{value:"limit",id:"limit",level:3},{value:"Examples",id:"examples",level:2},{value:"1. Expand all values in a multivalue field",id:"1-expand-all-values-in-a-multivalue-field",level:3},{value:"2. Limit the number of expanded values",id:"2-limit-the-number-of-expanded-values",level:3},{value:"3. Working with multiple multivalue fields",id:"3-working-with-multiple-multivalue-fields",level:3},{value:"Use-Case Example",id:"use-case-example",level:3}];function c(e){const n={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,l.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"mvexpand",children:"mvexpand"}),"\n",(0,s.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,s.jsx)(n.p,{children:"Expands the values of a multivalue field into separate events, creating one event for each value in the multivalue field."}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"mvexpand"})," command transforms a single event with multiple values into multiple events with single values, allowing for more detailed analysis of each value."]}),"\n",(0,s.jsx)(n.p,{children:"Note: This command cannot be applied to internal fields."}),"\n",(0,s.jsx)(n.h2,{id:"syntax",children:"Syntax"}),"\n",(0,s.jsxs)(n.p,{children:["The required syntax is in ",(0,s.jsx)(n.strong,{children:"bold"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"mvexpand"})," ",(0,s.jsx)(n.strong,{children:"<field>"})," ",(0,s.jsx)(n.br,{}),"\n","[limit=<int>]"]}),"\n",(0,s.jsx)(n.h2,{id:"required-arguments",children:"Required arguments"}),"\n",(0,s.jsx)(n.h3,{id:"field",children:"field"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Syntax:"})," ",(0,s.jsx)(n.code,{children:"<field>"})," ",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Description:"})," The name of the multivalue field to expand into separate events."]}),"\n",(0,s.jsx)(n.h2,{id:"optional-arguments",children:"Optional arguments"}),"\n",(0,s.jsx)(n.h3,{id:"limit",children:"limit"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Syntax:"})," ",(0,s.jsx)(n.code,{children:"limit=<int>"})," ",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Description:"})," Specifies the maximum number of values from the multivalue field to expand for each input event. ",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Default:"})," 0 (no limit)"]}),"\n",(0,s.jsx)(n.h2,{id:"examples",children:"Examples"}),"\n",(0,s.jsx)(n.h3,{id:"1-expand-all-values-in-a-multivalue-field",children:"1. Expand all values in a multivalue field"}),"\n",(0,s.jsx)(n.p,{children:'Create new events for each value in the multivalue field "tags".'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"... | mvexpand tags\n"})}),"\n",(0,s.jsx)(n.h3,{id:"2-limit-the-number-of-expanded-values",children:"2. Limit the number of expanded values"}),"\n",(0,s.jsx)(n.p,{children:'Create new events for only the first 10 values in the multivalue field "ip_addresses".'}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"... | mvexpand ip_addresses limit=10\n"})}),"\n",(0,s.jsx)(n.h3,{id:"3-working-with-multiple-multivalue-fields",children:"3. Working with multiple multivalue fields"}),"\n",(0,s.jsxs)(n.p,{children:["When you need to expand events with multiple multivalue fields, you can combine them first using the ",(0,s.jsx)(n.code,{children:"mvzip"})," function and then expand them."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'... | rex field=_raw "a=(?<a>\\d+)" max_match=5\n| rex field=_raw "b=(?<b>\\d+)" max_match=5\n| eval combined = mvzip(a,b)\n| mvexpand combined\n| rex field=combined "(?<value_a>\\d+),(?<value_b>\\d+)"\n| table _time value_a value_b\n'})}),"\n",(0,s.jsx)(n.h3,{id:"use-case-example",children:"Use-Case Example"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Analyzing user actions from access logs"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Problem:"})," A security analyst needs to analyze each action performed by users, but the actions are stored as a multivalue field in the log events."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Solution:"})," The ",(0,s.jsx)(n.code,{children:"mvexpand"})," command can separate each action into individual events for more detailed analysis."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"SPL command:"})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"index=security sourcetype=user_activity\n| eval timestamp=_time\n| fields timestamp, user_id, actions\n| mvexpand actions\n| stats count by user_id, actions\n| sort -count\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Explanation:"})}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"The search retrieves user activity logs."}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"eval"})," command preserves the original timestamp."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"fields"})," command selects only the relevant fields."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"mvexpand"}),' command creates a separate event for each value in the "actions" field.']}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"stats"})," command counts occurrences of each action by user."]}),"\n",(0,s.jsxs)(n.li,{children:["The ",(0,s.jsx)(n.code,{children:"sort"})," command organizes results by frequency (most frequent first)."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Example data:"})}),"\n",(0,s.jsx)(n.p,{children:"Before expansion:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:'timestamp           user_id    actions\n2024-07-12 09:15:23 user123    ["login", "view_report", "export_data", "logout"]\n2024-07-12 10:30:45 user456    ["login", "modify_settings", "create_user", "logout"]\n'})}),"\n",(0,s.jsx)(n.p,{children:"After expansion and stats:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"user_id    actions          count\nuser123    export_data      15\nuser456    create_user      12\nuser123    view_report      10\nuser456    modify_settings  8\nuser123    login            7\nuser456    login            7\nuser123    logout           7\nuser456    logout           7\n"})}),"\n",(0,s.jsxs)(n.p,{children:["This use case demonstrates how the ",(0,s.jsx)(n.code,{children:"mvexpand"})," command enables detailed analysis of individual values within multivalue fields, providing insights that would be difficult to obtain when the values are grouped together."]})]})}function u(e={}){const{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>d,a:()=>a});var s=i(7294);const l={},t=s.createContext(l);function a(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:a(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);