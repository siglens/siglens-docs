"use strict";(self.webpackChunksiglens_docs=self.webpackChunksiglens_docs||[]).push([[2427],{6060:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>a,contentTitle:()=>l,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var r=n(5893),t=n(1151);const i={},l="format",o={id:"spl-docs/format-command",title:"format",description:"Description",source:"@site/docs/spl-docs/format-command.md",sourceDirName:"spl-docs",slug:"/spl-docs/format-command",permalink:"/siglens-docs/spl-docs/format-command",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"fillnull",permalink:"/siglens-docs/spl-docs/fillnull-command"},next:{title:"gentimes",permalink:"/siglens-docs/spl-docs/gentimes-command"}},a={},c=[{value:"Description",id:"description",level:2},{value:"Syntax",id:"syntax",level:2},{value:"Required arguments",id:"required-arguments",level:2},{value:"Optional arguments",id:"optional-arguments",level:2},{value:"mvsep",id:"mvsep",level:3},{value:"maxresults",id:"maxresults",level:3},{value:"&lt;row prefix&gt;",id:"row-prefix",level:3},{value:"&lt;column prefix&gt;",id:"column-prefix",level:3},{value:"&lt;column separator&gt;",id:"column-separator",level:3},{value:"&lt;column end&gt;",id:"column-end",level:3},{value:"&lt;row separator&gt;",id:"row-separator",level:3},{value:"&lt;row end&gt;",id:"row-end",level:3},{value:"emptystr",id:"emptystr",level:3},{value:"Examples",id:"examples",level:2},{value:"1. Basic format with default settings",id:"1-basic-format-with-default-settings",level:3},{value:"2. Custom separators for SQL-like formatting",id:"2-custom-separators-for-sql-like-formatting",level:3},{value:"3. Limit the number of results",id:"3-limit-the-number-of-results",level:3},{value:"4. Custom multi-value field separator",id:"4-custom-multi-value-field-separator",level:3},{value:"5. Custom empty result message",id:"5-custom-empty-result-message",level:3},{value:"Use-Case Example",id:"use-case-example",level:3}];function d(e){const s={br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.h1,{id:"format",children:"format"}),"\n",(0,r.jsx)(s.h2,{id:"description",children:"Description"}),"\n",(0,r.jsxs)(s.p,{children:["Formats the results of a subsearch into a single result, placing that formatted result into a new field called ",(0,r.jsx)(s.code,{children:"search"}),". This command is typically used implicitly by subsearches to properly structure their output."]}),"\n",(0,r.jsxs)(s.p,{children:["The ",(0,r.jsx)(s.code,{children:"format"})," command allows customization of how multi-value fields and result rows are combined and separated in the output."]}),"\n",(0,r.jsx)(s.h2,{id:"syntax",children:"Syntax"}),"\n",(0,r.jsxs)(s.p,{children:["The required syntax is in ",(0,r.jsx)(s.strong,{children:"bold"}),"."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"format"})," ",(0,r.jsx)(s.br,{}),"\n",'[mvsep="<mv separator>"] ',(0,r.jsx)(s.br,{}),"\n","[maxresults=<int>] ",(0,r.jsx)(s.br,{}),"\n",'["<row prefix>" "<column prefix>" "<column separator>" "<column end>" "<row separator>" "<row end>"] ',(0,r.jsx)(s.br,{}),"\n",'[emptystr="<string>"]']}),"\n",(0,r.jsx)(s.p,{children:"Note: If you specify any row or column formatting options, you must specify all six of them."}),"\n",(0,r.jsx)(s.h2,{id:"required-arguments",children:"Required arguments"}),"\n",(0,r.jsx)(s.p,{children:"None."}),"\n",(0,r.jsx)(s.h2,{id:"optional-arguments",children:"Optional arguments"}),"\n",(0,r.jsx)(s.h3,{id:"mvsep",children:"mvsep"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'mvsep="<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The separator to use between values in multi-value fields. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"})," OR"]}),"\n",(0,r.jsx)(s.h3,{id:"maxresults",children:"maxresults"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:"maxresults=<int>"})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The maximum number of results to return from the subsearch. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"})," 0 (no limit)"]}),"\n",(0,r.jsx)(s.h3,{id:"row-prefix",children:"<row prefix>"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'"<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The string to insert at the beginning of each row. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"}),' "("']}),"\n",(0,r.jsx)(s.h3,{id:"column-prefix",children:"<column prefix>"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'"<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The string to insert at the beginning of each column value. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"}),' "("']}),"\n",(0,r.jsx)(s.h3,{id:"column-separator",children:"<column separator>"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'"<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The string to insert between column values within a row. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"})," AND"]}),"\n",(0,r.jsx)(s.h3,{id:"column-end",children:"<column end>"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'"<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The string to insert at the end of each column value. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"}),' ")"']}),"\n",(0,r.jsx)(s.h3,{id:"row-separator",children:"<row separator>"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'"<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The string to insert between rows. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"})," OR"]}),"\n",(0,r.jsx)(s.h3,{id:"row-end",children:"<row end>"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'"<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The string to insert at the end of each row. ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"}),' ")"']}),"\n",(0,r.jsx)(s.h3,{id:"emptystr",children:"emptystr"}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Syntax:"})," ",(0,r.jsx)(s.code,{children:'emptystr="<string>"'})," ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Description:"})," The value to output when the results are empty (containing no fields or values other than internal fields). ",(0,r.jsx)(s.br,{}),"\n",(0,r.jsx)(s.strong,{children:"Default:"})," NOT( )"]}),"\n",(0,r.jsx)(s.h2,{id:"examples",children:"Examples"}),"\n",(0,r.jsx)(s.h3,{id:"1-basic-format-with-default-settings",children:"1. Basic format with default settings"}),"\n",(0,r.jsx)(s.p,{children:"Format the results of a subsearch using the default formatting options."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"... | format\n"})}),"\n",(0,r.jsxs)(s.p,{children:["The default formatting produces output like: ",(0,r.jsx)(s.code,{children:"(field1=value1 AND field2=value2) OR (field1=value3 AND field2=value4)"})]}),"\n",(0,r.jsx)(s.h3,{id:"2-custom-separators-for-sql-like-formatting",children:"2. Custom separators for SQL-like formatting"}),"\n",(0,r.jsx)(s.p,{children:"Format a subsearch result to use SQL-like syntax for use with another system."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'... | format " " " " "=" " " " OR " " "\n'})}),"\n",(0,r.jsxs)(s.p,{children:["This creates output like: ",(0,r.jsx)(s.code,{children:"field1=value1 OR field2=value2"})]}),"\n",(0,r.jsx)(s.h3,{id:"3-limit-the-number-of-results",children:"3. Limit the number of results"}),"\n",(0,r.jsx)(s.p,{children:"Restrict the subsearch to return only the first 5 results."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:"... | format maxresults=5\n"})}),"\n",(0,r.jsx)(s.h3,{id:"4-custom-multi-value-field-separator",children:"4. Custom multi-value field separator"}),"\n",(0,r.jsx)(s.p,{children:"Change how multiple values for the same field are joined together."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'... | format mvsep=","\n'})}),"\n",(0,r.jsx)(s.h3,{id:"5-custom-empty-result-message",children:"5. Custom empty result message"}),"\n",(0,r.jsx)(s.p,{children:"Define a custom message when the subsearch returns no results."}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'... | format emptystr="NO_MATCHING_RESULTS"\n'})}),"\n",(0,r.jsx)(s.h3,{id:"use-case-example",children:"Use-Case Example"}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Creating a dynamic IN clause for filtering data"})}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Problem:"})," A user needs to create a dynamic filter based on the results of a previous search, similar to an SQL IN clause."]}),"\n",(0,r.jsxs)(s.p,{children:[(0,r.jsx)(s.strong,{children:"Solution:"})," Use the ",(0,r.jsx)(s.code,{children:"format"})," command to structure the subsearch results into a format that can be used as a filter condition."]}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"SPL command:"})}),"\n",(0,r.jsx)(s.pre,{children:(0,r.jsx)(s.code,{children:'| search [\nsearch index=security sourcetype=firewall action=blocked\n| stats count by src_ip\n| where count > 100\n| fields src_ip\n| format maxresults=1000 " " "src_ip=" " OR " " " " " "\n]\n'})}),"\n",(0,r.jsx)(s.p,{children:(0,r.jsx)(s.strong,{children:"Explanation:"})}),"\n",(0,r.jsxs)(s.ol,{children:["\n",(0,r.jsx)(s.li,{children:"The subsearch finds IP addresses that have been blocked more than 100 times"}),"\n",(0,r.jsxs)(s.li,{children:["The ",(0,r.jsx)(s.code,{children:"fields"})," command extracts just the src_ip field"]}),"\n",(0,r.jsxs)(s.li,{children:["The ",(0,r.jsx)(s.code,{children:"format"})," command structures the results into a space-separated list like: ",(0,r.jsx)(s.code,{children:"src_ip=192.168.1.1 OR src_ip=10.10.10.5 OR src_ip=172.16.0.1"})]}),"\n",(0,r.jsx)(s.li,{children:"The main search uses this formatted string as a filter condition"}),"\n"]}),"\n",(0,r.jsxs)(s.p,{children:["This use case demonstrates how the ",(0,r.jsx)(s.code,{children:"format"})," command creates dynamic filter conditions based on search results, enabling more flexible and powerful data analysis."]})]})}function h(e={}){const{wrapper:s}={...(0,t.a)(),...e.components};return s?(0,r.jsx)(s,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},1151:(e,s,n)=>{n.d(s,{Z:()=>o,a:()=>l});var r=n(7294);const t={},i=r.createContext(t);function l(e){const s=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(i.Provider,{value:s},e.children)}}}]);