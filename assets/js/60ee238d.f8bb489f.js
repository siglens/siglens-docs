"use strict";(self.webpackChunksiglens_docs=self.webpackChunksiglens_docs||[]).push([[5382],{3760:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>t,default:()=>p,frontMatter:()=>i,metadata:()=>a,toc:()=>d});var l=s(5893),r=s(1151);const i={},t="PromQL APIs",a={id:"promql-apis",title:"PromQL APIs",description:"Instant Query",source:"@site/docs/promql-apis.md",sourceDirName:".",slug:"/promql-apis",permalink:"/siglens-docs/promql-apis",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"Elasticsearch APIs",permalink:"/siglens-docs/elasticsearch-apis"},next:{title:"SigLens Metrics",permalink:"/siglens-docs/siglens-metrics"}},c={},d=[{value:"Instant Query",id:"instant-query",level:3},{value:"Range Query",id:"range-query",level:3},{value:"List All Labels",id:"list-all-labels",level:3},{value:"Get Label Values",id:"get-label-values",level:3},{value:"Get Series by Label Matchers",id:"get-series-by-label-matchers",level:3},{value:"UI Query",id:"ui-query",level:3},{value:"Build Information",id:"build-information",level:3},{value:"Write Metrics",id:"write-metrics",level:3}];function o(e){const n={code:"code",h1:"h1",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h1,{id:"promql-apis",children:"PromQL APIs"}),"\n",(0,l.jsx)(n.h3,{id:"instant-query",children:"Instant Query"}),"\n",(0,l.jsx)(n.p,{children:"Query the current value of your metrics. Use this when you need the latest data point."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"GET /promql/api/v1/query\nPOST /promql/api/v1/query\n"})}),"\n",(0,l.jsx)(n.p,{children:"Parameters:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"query"})," (required): PromQL expression to evaluate"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"time"}),": Evaluation timestamp (RFC3339 or Unix timestamp). Optional, defaults to current time"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'# Get current value of a metric\ncurl -X GET "http://localhost:5122/promql/api/v1/query?query=http_requests_total"\n\n# Calculate rate of requests\ncurl -X POST "http://localhost:5122/promql/api/v1/query" \\\n  -d \'query=rate(http_requests_total[5m])\'\n'})}),"\n",(0,l.jsx)(n.h3,{id:"range-query",children:"Range Query"}),"\n",(0,l.jsx)(n.p,{children:"Query metrics data over a time range."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"GET /promql/api/v1/query_range\nPOST /promql/api/v1/query_range\n"})}),"\n",(0,l.jsx)(n.p,{children:"Parameters:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"query"})," (required): PromQL expression to evaluate"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"start"})," (required): Start timestamp (RFC3339 or Unix timestamp)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"end"})," (required): End timestamp (RFC3339 or Unix timestamp)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"step"})," (required): Query resolution step width (duration or float number of seconds)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X GET "http://localhost:5122/promql/api/v1/query_range?query=rate(http_requests_total[5m])&start=2024-01-01T00:00:00Z&end=2024-01-02T00:00:00Z&step=1h"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"list-all-labels",children:"List All Labels"}),"\n",(0,l.jsx)(n.p,{children:"Get a list of all label names in your metrics."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"GET /promql/api/v1/labels\nPOST /promql/api/v1/labels\n"})}),"\n",(0,l.jsx)(n.p,{children:"Parameters:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"start"}),": Start timestamp (optional)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"end"}),": End timestamp (optional)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X GET "http://localhost:5122/promql/api/v1/labels"\n'})}),"\n",(0,l.jsx)(n.h3,{id:"get-label-values",children:"Get Label Values"}),"\n",(0,l.jsx)(n.p,{children:"Get all possible values for a specific label."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"GET /promql/api/v1/label/{labelName}/values\n"})}),"\n",(0,l.jsx)(n.p,{children:"Parameters:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"labelName"})," (required): Name of the label"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"start"}),": Start timestamp (optional)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"end"}),": End timestamp (optional)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Get all values for the 'job' label\ncurl -X GET \"http://localhost:5122/promql/api/v1/label/job/values\"\n"})}),"\n",(0,l.jsx)(n.h3,{id:"get-series-by-label-matchers",children:"Get Series by Label Matchers"}),"\n",(0,l.jsx)(n.p,{children:"Find time series that match certain label sets."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"GET /promql/api/v1/series\nPOST /promql/api/v1/series\n"})}),"\n",(0,l.jsx)(n.p,{children:"Parameters:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"match[]"}),": Series selector string (repeated)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"start"}),": Start timestamp (optional)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"end"}),": End timestamp (optional)"]}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Find series matching a label selector\ncurl -X GET \"http://localhost:5122/promql/api/v1/series?match[]=http_requests_total{job='apiserver'}\"\n"})}),"\n",(0,l.jsx)(n.h3,{id:"ui-query",children:"UI Query"}),"\n",(0,l.jsx)(n.p,{children:"Special endpoint for UI-based metric exploration."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"POST /promql/api/ui/query\n"})}),"\n",(0,l.jsx)(n.p,{children:"Request body:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "query": "http_requests_total",\n  "start": "2024-01-01T00:00:00Z",\n  "end": "2024-01-02T00:00:00Z"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"build-information",children:"Build Information"}),"\n",(0,l.jsx)(n.p,{children:"Get version and build details of the PromQL service."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"GET /promql/api/v1/status/buildinfo\n"})}),"\n",(0,l.jsx)(n.p,{children:"Example Response:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "version": "2.40.0",\n  "revision": "40c56f5",\n  "branch": "HEAD",\n  "buildUser": "root@hostname",\n  "buildDate": "20240115-12:00:00",\n  "goVersion": "go1.19.5"\n}\n'})}),"\n",(0,l.jsx)(n.h3,{id:"write-metrics",children:"Write Metrics"}),"\n",(0,l.jsx)(n.p,{children:"Write new metrics data points."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{children:"POST /promql/api/v1/write\n"})}),"\n",(0,l.jsx)(n.p,{children:"Example:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'curl -X POST "http://localhost:8081/promql/api/v1/write" \\\n  -H \'Content-Type: application/json\' \\\n  -d \'{\n    "metrics": [\n      {\n        "name": "http_requests_total",\n        "labels": {"method": "GET", "endpoint": "/api/v1"},\n        "value": 42,\n        "timestamp": "2024-01-15T12:00:00Z"\n      }\n    ]\n  }\'\n'})})]})}function p(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},1151:(e,n,s)=>{s.d(n,{Z:()=>a,a:()=>t});var l=s(7294);const r={},i=l.createContext(r);function t(e){const n=l.useContext(i);return l.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:t(e.components),l.createElement(i.Provider,{value:n},e.children)}}}]);