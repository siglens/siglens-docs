<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-spl-docs/evaluation-functions/comparison-conditional-functions" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">Comparison and Conditional functions | SigLens Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://siglens.github.io/siglens-docs/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://siglens.github.io/siglens-docs/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://siglens.github.io/siglens-docs/spl-docs/evaluation-functions/comparison-conditional-functions"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Comparison and Conditional functions | SigLens Docs"><meta data-rh="true" name="description" content="This list includes functions that can be used to return values based on conditions or compare different values."><meta data-rh="true" property="og:description" content="This list includes functions that can be used to return values based on conditions or compare different values."><link data-rh="true" rel="icon" href="/siglens-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://siglens.github.io/siglens-docs/spl-docs/evaluation-functions/comparison-conditional-functions"><link data-rh="true" rel="alternate" href="https://siglens.github.io/siglens-docs/spl-docs/evaluation-functions/comparison-conditional-functions" hreflang="en"><link data-rh="true" rel="alternate" href="https://siglens.github.io/siglens-docs/spl-docs/evaluation-functions/comparison-conditional-functions" hreflang="x-default"><link rel="stylesheet" href="/siglens-docs/assets/css/styles.f7ef957f.css">
<script src="/siglens-docs/assets/js/runtime~main.29d66bf2.js" defer="defer"></script>
<script src="/siglens-docs/assets/js/main.fa444b49.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/siglens-docs/"><div class="navbar__logo"><img src="/siglens-docs/img/logo.svg" alt="SigLens" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/siglens-docs/img/logo.svg" alt="SigLens" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SigLens Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/siglens-docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/siglens/siglens" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/key-concepts">Key Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/installation">Installation</a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/log-ingestion">Log Ingestion</a><button aria-label="Expand sidebar category &#x27;Log Ingestion&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/metric-ingestion">Metric Ingestion</a><button aria-label="Expand sidebar category &#x27;Metric Ingestion&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/instrumentation-for-traces">Instrumentation for Traces</a><button aria-label="Expand sidebar category &#x27;Instrumentation for Traces&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/migration">Migration</a><button aria-label="Expand sidebar category &#x27;Migration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/siglens-docs/category/splunk-commands">Splunk Commands</a><button aria-label="Collapse sidebar category &#x27;Splunk Commands&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/splunk-commands">Overview of Supported SPL Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/common-usecases">Common Use-Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/bin-command">bin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/dedup-command">dedup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/eval-command">eval</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/extract-command">extract</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/fields-command">fields</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/fillnull-command">fillnull</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/format-command">format</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/gentimes-command">gentimes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/head-command">head</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/inputlookup-command">inputlookup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/makemv-command">makemv</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/mvexpand-command">mvexpand</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/rare-command">rare</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/regex-command">regex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/rename-command">rename</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/rex-command">rex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/search-command">search</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/sort-command">sort</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/stats-command">stats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/streamstats-command">streamstats</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/tail-command">tail command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/timechart-command">timechart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/tojson-command">tojson</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/top-command">top</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/transaction-command">transaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/where-command">where</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/time-modifiers">Time Modifiers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/siglens-docs/category/evaluation-functions">Evaluation Functions</a><button aria-label="Collapse sidebar category &#x27;Evaluation Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/overview">Overview of SPL eval functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/comparison-conditional-functions">Comparison and Conditional functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/conversion-functions">Conversion Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/informational-functions">Informational Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/mathematical-functions">Mathematical Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/multivalue-functions">Multivalue functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/statistical-functions">Statistical eval functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/text-functions">Text functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/trig-hyperbolic-functions">Trigonometric and Hyperbolic functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/time-functions">Date and Time Functions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/evaluation-functions/time-variables">Using time variables</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/siglens-docs/category/aggregate-functions">Aggregate Functions</a><button aria-label="Expand sidebar category &#x27;Aggregate Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siglens-docs/grafana-integrations/prometheus-data-source">Grafana Integrations</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/splunk-apis">Splunk APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/promql-apis">PromQL APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/siglens-metrics">SigLens Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/searching-logs">Searching Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/log-query-builder">Log Query Builder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/dashboards">Dashboards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/saved-searches">Saved Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/alerts">Alerts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/cluster-health">Cluster Health</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/retention">Cluster Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/configuration">SigLens Configuration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/oss-vs-enterprise-features">SigLens: Open Source vs Enterprise Edition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/contribution-guidelines">Contribution Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/community">Community</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/siglens-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/siglens-docs/category/splunk-commands"><span itemprop="name">Splunk Commands</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/siglens-docs/category/evaluation-functions"><span itemprop="name">Evaluation Functions</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Comparison and Conditional functions</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Comparison and Conditional functions</h1>
<p><em>This list includes functions that can be used to return values based on conditions or compare different values.</em></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="casecondition1-value1-condition2-value2-">case(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)<a href="#casecondition1-value1-condition2-value2-" class="hash-link" aria-label="Direct link to case(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)" title="Direct link to case(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)">​</a></h2>
<p>This function takes in pairs of conditions and values and returns the value corresponding to the first condition that evaluated to <code>true</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;condition&gt;</code> is a Boolean expression that evaluates to <code>true</code> or <code>false</code>.</li>
<li><code>&lt;value&gt;</code> can be a string or a numeric literal.</li>
<li>If all the conditions are <code>false</code>, the default value returned is <code>NULL</code>.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example">Use-Case Example<a href="#use-case-example" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Categorizing Sales Performance</strong></p>
<p><strong>Problem:</strong> In sales data analysis, it&#x27;s crucial to categorize sales amounts into performance ratings to easily identify and differentiate between high and low-performing sales. This categorization helps in understanding sales trends and making informed decisions.</p>
<p><strong>Solution:</strong> To categorize sales amounts into distinct performance ratings, the <code>case</code> function can be used within an <code>eval</code> command. This approach allows for evaluating <code>sales_amount</code> against a series of conditions, assigning a corresponding performance rating based on the first condition met.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval sales_rating=case(sales_amount &gt;= 10000, &quot;Excellent&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sales_amount &gt;= 5000, &quot;Good&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sales_amount &gt;= 1000, &quot;Average&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sales_amount &gt; 0, &quot;Below Average&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    sales_amount = 0, &quot;No Sale&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> command used with <code>case</code> function is used to create a new field <code>sales_rating</code> based on the <code>sales_amount</code>.</li>
<li>It evaluates <code>sales_amount</code> against a series of conditions in sequence:</li>
</ol>
<ul>
<li>If <code>sales_amount</code> is greater than or equal to 10,000, it assigns &quot;Excellent&quot;.</li>
<li>If <code>sales_amount</code> is greater than or equal to 5,000 but less than 10,000, it assigns &quot;Good&quot;.</li>
<li>If <code>sales_amount</code> is greater than or equal to 1,000 but less than 5,000, it assigns &quot;Average&quot;.</li>
<li>If <code>sales_amount</code> is greater than 0 but less than 1,000, it assigns &quot;Below Average&quot;.</li>
<li>If <code>sales_amount</code> is exactly 0, it assigns &quot;No Sale&quot;.</li>
</ul>
<ol start="3">
<li>This categorization allows for easy identification and differentiation of sales performance, aiding in the analysis and decision-making process.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="validatecondition1-value1-condition2-value2-">validate(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)<a href="#validatecondition1-value1-condition2-value2-" class="hash-link" aria-label="Direct link to validate(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)" title="Direct link to validate(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)">​</a></h2>
<p>This function is opposite of case function. It takes in pairs of conditions and values and returns the value corresponding to the first condition that evaluated to <code>false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-1">Usage<a href="#usage-1" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;condition&gt;</code> is a Boolean expression that evaluates to <code>true</code> or <code>false</code>.</li>
<li><code>&lt;value&gt;</code> can either be a string or a numeric literal.</li>
<li>If all conditions are <code>true</code>, the default value returned is <code>NULL</code>.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-1">Use-Case Example<a href="#use-case-example-1" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Identifying Network Connection Issues</strong></p>
<p><strong>Problem:</strong> In network monitoring and analysis, identifying potential issues with network connections is crucial for maintaining system integrity and performance. Issues such as loopback connections, use of non-standard protocols, and invalid port numbers can indicate misconfigurations or malicious activities.</p>
<p><strong>Solution:</strong> To efficiently identify potential network connection issues, a command can be utilized to analyze network traffic logs. This command employs a custom <code>validate</code> function to check for common issues based on <code>src_ip</code>, <code>protocol</code>, and <code>port</code> fields.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval connection_issues = validate(</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    src_ip != dest_ip, &quot;Possible loopback connection&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    match(protocol, &quot;^(TCP|UDP|ICMP)$&quot;), &quot;Non-standard protocol&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    port &gt;= 1 AND port &lt;= 65535, &quot;Invalid port number&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>validate</code> function is used to apply multiple conditions to the network traffic data:</li>
</ol>
<ul>
<li><strong>Loopback Connection Check</strong>: If <code>src_ip</code> equals <code>dest_ip</code>, indicating a loopback connection, the condition is false, and the message <code>&quot;Possible loopback connection&quot;</code> is returned.</li>
<li><strong>Protocol Check</strong>: If the <code>protocol</code> does not match TCP, UDP, or ICMP, indicating the use of a non-standard protocol, the condition is false, and the message <code>&quot;Non-standard protocol&quot;</code> is returned.</li>
<li><strong>Port Number Check</strong>: If the <code>port</code> is not within the valid range of 1 to 65535, indicating an invalid port number, the condition is false, and the message <code>&quot;Invalid port number&quot;</code> is returned.</li>
</ul>
<ol start="2">
<li>If all conditions are true (i.e., no issues found), the <code>connection_issues</code> field will be <code>NULL</code>, indicating the absence of the identified potential issues.</li>
</ol>
<p>This method allows for the quick identification of common network connection issues, aiding in network analysis and security monitoring.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="coalescevalues">coalesce(&lt;values&gt;)<a href="#coalescevalues" class="hash-link" aria-label="Direct link to coalesce(&lt;values&gt;)" title="Direct link to coalesce(&lt;values&gt;)">​</a></h2>
<p>This function takes in one or more values and returns the first value that is not <code>NULL</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-2">Usage<a href="#usage-2" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;value&gt;</code> can be a field name, string or numeric literal or an expression.</li>
<li>If all the values are <code>NULL</code>, it returns <code>NULL</code>.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-2">Use-Case Example<a href="#use-case-example-2" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Identifying Users in Data Records</strong></p>
<p><strong>Problem:</strong> In datasets containing user information, it&#x27;s common to encounter records with missing data. Specifically, identifying users can be challenging when their <code>username</code>, <code>login_id</code>, or <code>email</code> fields are inconsistently filled, leading to difficulties in user data analysis and management.</p>
<p><strong>Solution:</strong> To address this issue, the <code>coalesce</code> function can be employed within an <code>eval</code> command. This function systematically checks each specified field (<code>username</code>, <code>login_id</code>, <code>email</code>) for a non-<code>NULL</code> value, returning the first valid identifier it finds. If all specified fields are <code>NULL</code>, it defaults to a predefined value, such as &quot;Unknown&quot;.</p>
<p>This command determines the user&#x27;s identity by checking the fields <code>username</code>, <code>login_id</code>, or <code>email</code> in that order, returning the first non-<code>NULL</code> value found. If all fields are <code>NULL</code>, it defaults to <code>Unknown</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval user=coalesce(username, login_id, email, &quot;Unknown&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>coalesce</code> function is employed within an <code>eval</code> command to create a new field named <code>user</code>, which serves as a identifier across data records.</li>
<li>It sequentially checks the <code>username</code>, <code>login_id</code>, and <code>email</code> fields for a non-<code>NULL</code> value:</li>
</ol>
<ul>
<li>First, it checks the <code>username</code> field; if it is not <code>NULL</code>, this value is used.</li>
<li>If <code>username</code> is <code>NULL</code>, it proceeds to check the <code>login_id</code> field.</li>
<li>If <code>login_id</code> is also <code>NULL</code>, it checks the <code>email</code> field.</li>
<li>If all these fields are <code>NULL</code>, the function defaults to assigning &quot;Unknown&quot; to the <code>user</code> field.</li>
</ul>
<ol start="3">
<li>This systematic approach ensures every record is assigned an identifier, enhancing data completeness and reliability.</li>
<li>By prioritizing the <code>username</code>, followed by <code>login_id</code>, and finally <code>email</code>, the method utilizes the most relevant available information for user identification.</li>
</ol>
<p>This technique is particularly beneficial for data analysis and management, facilitating the identification process of users across datasets.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="searchmatchsearch_str">searchmatch(&lt;search_str&gt;)<a href="#searchmatchsearch_str" class="hash-link" aria-label="Direct link to searchmatch(&lt;search_str&gt;)" title="Direct link to searchmatch(&lt;search_str&gt;)">​</a></h2>
<p>This function returns <code>true</code> if the record matches for the search string <code>&lt;search_str&gt;</code>; otherwise it returns <code>false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-3">Usage<a href="#usage-3" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;search_str&gt;</code> is a string containing sets of field value pairs like <code>&quot;field1=value1 field2=value2&quot;</code>.</li>
<li>This function will search for value in the corresponding field. If all the searches for field value pairs are successful, the functions returns <code>true</code>; otherwise it returns <code>false</code>.</li>
<li>Values presented in the search string can have wildcard characters <code>*</code> or <code>?</code>.</li>
<li>Wildcard character <code>*</code> is used to match multiple characters.</li>
<li>Wildcard character <code>?</code> is used to match a single character.</li>
<li><code>&lt;search_str&gt;</code> could also have a single string literal. In this case, this string literal would be searched in all the available fields and if any one matches the <code>&lt;search_str&gt;</code>, it returns <code>true</code>; otherwise it returns <code>false</code>.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-3">Use-Case Example<a href="#use-case-example-3" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Finding Important Server Related Issue in Log Data</strong></p>
<p><strong>Problem:</strong> In system monitoring and log analysis, quickly identifying and categorizing errors is crucial for maintaining system health and performance. Specifically, distinguishing server errors from other types of errors based on log data can be challenging due to the volume and variety of log messages.</p>
<p><strong>Solution:</strong> To address this challenge, a specific command can be used to analyze log data, checking for the presence of the string &quot;error&quot; in the <code>error_msg</code> field and for HTTP error codes in the 500 range in the <code>http_status</code> field. This command employs the <code>eval</code> function combined with the <code>if</code> and <code>searchmatch</code> functions to categorize errors efficiently.</p>
<p>The following command checks for the presence of the string &quot;error&quot; in the <code>error_msg</code> field and for HTTP error codes in the 500 range in the <code>http_status</code> field. If both conditions are met, it returns <code>true</code>; otherwise, it returns <code>false</code>. When combined with the <code>if</code> command, this logic assigns <code>&quot;Server error&quot;</code> to the <code>error_type</code> field if the conditions are true, and <code>&quot;Unknown&quot;</code> otherwise.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval error_type=if(searchmatch(&quot;error_msg=*error* http_status=5??&quot;), </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;Server Error&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        &quot;Unknown&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> function creates a new field named <code>error_type</code>, which is used to categorize errors.</li>
<li>The <code>if</code> function checks two conditions using the <code>searchmatch</code> function:</li>
</ol>
<ul>
<li>The presence of the substring &quot;error&quot; within the <code>error_msg</code> field.</li>
<li>HTTP status codes starting with &quot;5&quot;, indicating server errors, within the <code>http_status</code> field.</li>
</ul>
<ol start="3">
<li>If both conditions are met, the <code>if</code> function assigns <code>&quot;Server Error&quot;</code> to the <code>error_type</code> field, indicating a server-related issue.</li>
<li>If either condition is not met, it defaults to assigning <code>&quot;Unknown&quot;</code>, covering all other cases or when error details are insufficient.</li>
</ol>
<p>This method allows for the precise identification and categorization of errors, facilitating faster response and resolution of server-related issues, thereby improving system reliability and performance.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="ifpredicate-true_value-false_value">if(&lt;predicate&gt;, &lt;true_value&gt;, &lt;false_value&gt;)<a href="#ifpredicate-true_value-false_value" class="hash-link" aria-label="Direct link to if(&lt;predicate&gt;, &lt;true_value&gt;, &lt;false_value&gt;)" title="Direct link to if(&lt;predicate&gt;, &lt;true_value&gt;, &lt;false_value&gt;)">​</a></h2>
<p>This function returns <code>&lt;true_value&gt;</code> if <code>&lt;predicate&gt;</code> evaluates to <code>true</code>, otherwise it returns <code>&lt;false_value&gt;</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-4">Usage<a href="#usage-4" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;predicate&gt;</code> is a Boolean expression that evaluates to <code>true</code> or <code>false</code>.</li>
<li><code>&lt;true_value&gt;</code> and <code>&lt;false_value&gt;</code> can be a field name, string or numeric literal or an expression.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-4">Use-Case Example<a href="#use-case-example-4" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Identifying High-Risk Transactions</strong></p>
<p><strong>Problem:</strong> In financial data analysis, identifying transactions that may pose a high risk is crucial for fraud detection and risk management. Transactions that exceed a certain amount and originate from countries other than the USA are often considered higher risk due to various regulatory and risk factors.</p>
<p><strong>Solution:</strong> To efficiently identify high-risk transactions, a command can be used to analyze transaction data. This command employs the <code>eval</code> function along with a conditional <code>if</code> statement to categorize transactions based on the <code>transaction_amount</code> and <code>country</code> fields.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval high_risk=if(transaction_amount &gt; 10000 AND country != &quot;USA&quot;, &quot;Yes&quot;, &quot;No&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> function is used to create a new field named <code>high_risk</code>, which indicates whether a transaction is considered high risk.</li>
<li>The <code>if</code> statement checks two conditions:</li>
</ol>
<ul>
<li>Whether the <code>transaction_amount</code> exceeds <code>10000</code>.</li>
<li>Whether the transaction did not originate from the <code>USA</code> (<code>country != &quot;USA&quot;</code>).</li>
</ul>
<ol start="3">
<li>If both conditions are met, the transaction is categorized as <code>&quot;Yes&quot;</code> for high risk.</li>
<li>If either condition is not met, the transaction is categorized as <code>&quot;No&quot;</code> for high risk.</li>
</ol>
<p>This approach allows for the targeted identification of transactions that may require further investigation or monitoring, enhancing fraud detection and risk management efforts.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="invalue-list">in(&lt;value&gt;, &lt;list&gt;)<a href="#invalue-list" class="hash-link" aria-label="Direct link to in(&lt;value&gt;, &lt;list&gt;)" title="Direct link to in(&lt;value&gt;, &lt;list&gt;)">​</a></h2>
<p>This function returns whether <code>&lt;value&gt;</code> is present in <code>&lt;list&gt;</code>. If present it returns <code>true</code>; otherwise it returns <code>false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-5">Usage<a href="#usage-5" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;value&gt;</code> can be a field name, string or numeric literal or an expression.</li>
<li><code>&lt;list&gt;</code> is a list of values that can be a field name, string or numeric literal or an expression.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-5">Use-Case Example<a href="#use-case-example-5" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Validating HTTP Status Codes</strong></p>
<p><strong>Problem:</strong> In web service monitoring and log analysis, quickly identifying valid HTTP responses is essential for ensuring service availability and performance. Validating that the status codes of responses fall within a specific range of successful codes (200, 201, or 202) can be challenging due to the variety of possible HTTP status codes.</p>
<p><strong>Solution:</strong> To efficiently validate HTTP status codes, a command can be utilized to analyze log data. This command employs the <code>eval</code> function combined with the <code>if</code> and <code>in</code> functions to check if the <code>status</code> field contains a valid status code (200, 201, or 202).</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval is_valid=if(in(status, 200, 201, 202), &quot;TRUE&quot;, &quot;FALSE&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> function is used to create a new field named <code>is_valid</code>, which indicates whether a status code is considered valid.</li>
<li>The <code>if</code> function checks if the <code>status</code> field&#x27;s value is within the list of valid status codes (200, 201, or 202) using the <code>in</code> function.</li>
<li>If the status code is one of the valid codes, the <code>if</code> function assigns <code>&quot;TRUE&quot;</code> to the <code>is_valid</code> field, indicating a successful HTTP response.</li>
<li>If the status code does not match any of the valid codes, it assigns <code>&quot;FALSE&quot;</code> to the <code>is_valid</code> field, indicating an unsuccessful or non-standard HTTP response.</li>
</ol>
<p>This method allows for the quick identification of valid HTTP responses, facilitating effective monitoring and analysis of web service health and performance.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="likestr-pattern">like(&lt;str&gt;, &lt;pattern&gt;)<a href="#likestr-pattern" class="hash-link" aria-label="Direct link to like(&lt;str&gt;, &lt;pattern&gt;)" title="Direct link to like(&lt;str&gt;, &lt;pattern&gt;)">​</a></h2>
<p>This function checks if <code>&lt;str&gt;</code> matches <code>&lt;pattern&gt;</code> and returns <code>true</code> for a successful match; otherwise it returns <code>false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-6">Usage<a href="#usage-6" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;str&gt;</code> can be a field name or a string literal.</li>
<li><code>&lt;pattern&gt;</code> is a string that can either be a normal string literal or a string literal with wildcard.</li>
<li>Wildcard character <code>%</code> is used to match multiple characters.</li>
<li>Wildcard character <code>_</code> is used to match a single character.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3>
<p>The following command checks if the value in the field <code>first_name</code> begins with <code>A</code>. If so, it returns <code>true</code>; otherwise it returns <code>false</code>. Based on this evaluation we get value <code>yes</code> or <code>no</code> from the <code>if</code> function.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval starts_with_a=if(like(first_name, &quot;A%&quot;), &quot;yes&quot;, &quot;no&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-6">Use-Case Example<a href="#use-case-example-6" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Analyzing Devices Used to Access Service</strong></p>
<p><strong>Problem:</strong> Understanding the types of devices used to access a service is crucial for optimizing user experience and tailoring service offerings. Differentiating between device types (e.g., iPhone, Android, Windows, Mac) based on user agent strings in access logs can be challenging due to the diversity of devices and the complexity of user agent strings.</p>
<p><strong>Solution:</strong> To effectively analyze types of devices used to access service, a command can be utilized to categorize access logs by device type based on the <code>user_agent</code> field. This command employs the <code>eval</code> function combined with the <code>case</code> function to match patterns in the <code>user_agent</code> strings and categorize them accordingly.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval device_type=case( </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        like(lower(user_agent), &quot;%iphone%&quot;), &quot;iPhone&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        like(lower(user_agent), &quot;%android%&quot;), &quot;Android&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        like(lower(user_agent), &quot;%windows%&quot;), &quot;Windows&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        like(lower(user_agent), &quot;%macintosh%&quot;), &quot;Mac&quot;, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        like(user_agent, &quot;%&quot;), &quot;Other&quot;) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    | stats count by device_type</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> function creates a new field named <code>device_type</code>, which indicates the type of device used to access the service.</li>
<li>The <code>case</code> function evaluates multiple conditions in sequence, checking for the presence of specific substrings within the <code>user_agent</code> string (converted to lowercase for case-insensitive matching):</li>
</ol>
<ul>
<li>If the <code>user_agent</code> contains &quot;iphone&quot;, the device is categorized as &quot;iPhone&quot;.</li>
<li>If it contains &quot;android&quot;, the device is categorized as &quot;Android&quot;.</li>
<li>If it contains &quot;windows&quot;, the device is categorized as &quot;Windows&quot;.</li>
<li>If it contains &quot;macintosh&quot;, the device is categorized as &quot;Mac&quot;.</li>
<li>If none of these conditions are met, the device is categorized as &quot;Other&quot;.</li>
</ul>
<ol start="3">
<li>The <code>stats count by device_type</code> command then counts the number of occurrences for each device type, providing insights into the most commonly used devices to access the service.</li>
</ol>
<p>This approach enables a detailed analysis of device used to access your service, informing decisions related to service optimization and user experience enhancement.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="matchstr-regex">match(&lt;str&gt;, &lt;regex&gt;)<a href="#matchstr-regex" class="hash-link" aria-label="Direct link to match(&lt;str&gt;, &lt;regex&gt;)" title="Direct link to match(&lt;str&gt;, &lt;regex&gt;)">​</a></h2>
<p>This function matches <code>&lt;str&gt;</code> with regular expression pattern <code>&lt;regex&gt;</code> and returns <code>true</code> if match is successful; otherwise it returns <code>false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-7">Usage<a href="#usage-7" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;str&gt;</code> can be a field name or a string literal.</li>
<li><code>&lt;regex&gt;</code> is a regular expression pattern in form of a string literal.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-7">Use-Case Example<a href="#use-case-example-7" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Identifying Google Email IDs</strong></p>
<p><strong>Problem:</strong> In data analysis involving user information, it&#x27;s often useful to quickly identify users with email addresses belonging to a specific domain, such as Google. This can be challenging due to the variety of email formats and domains.</p>
<p><strong>Solution:</strong> To efficiently identify Google email IDs, a command can be used to analyze the <code>email</code> field in the dataset. This command employs the <code>eval</code> function combined with the <code>match</code> function to check if the email addresses end with &quot;@google.com&quot;.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval is_google_id=if(match(email, &quot;^([^@]+)@google.com&quot;), &quot;yes&quot;, &quot;no&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> function creates a new field named <code>is_google_id</code>, which indicates whether an email ID is associated with Google.</li>
<li>The <code>match</code> function is used to apply a regular expression that checks if the <code>email</code> field matches the pattern <code>^([^@]+)@google.com</code>. This pattern looks for strings that:</li>
</ol>
<ul>
<li>Start with any character sequence except the &quot;@&quot; symbol (<code>^([^@]+)</code>), followed by &quot;@google.com&quot;.</li>
</ul>
<ol start="3">
<li>If the <code>email</code> field matches this pattern, the <code>match</code> function returns <code>true</code>, and the <code>if</code> function assigns <code>&quot;yes&quot;</code> to the <code>is_google_id</code> field.</li>
<li>If the <code>email</code> field does not match this pattern, the <code>match</code> function returns <code>false</code>, and the <code>if</code> function assigns <code>&quot;no&quot;</code> to the <code>is_google_id</code> field.</li>
</ol>
<p>This method allows for the quick identification of Google email IDs, facilitating targeted analysis or actions based on user email domains.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="null">null()<a href="#null" class="hash-link" aria-label="Direct link to null()" title="Direct link to null()">​</a></h2>
<p>This function takes no arguments and returns NULL. The evaluation engine uses NULL to represent &quot;no value&quot;. Setting a field value to NULL clears the field value.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-8">Usage<a href="#usage-8" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li>NULL values are field values that are missing in a some results but present in another results.</li>
<li>You can use this function with the eval and where commands, and as part of eval expressions.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-8">Use-Case Example<a href="#use-case-example-8" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Resetting Field Values in Inventory Data</strong></p>
<p><strong>Problem:</strong> In an inventory management system, there are instances where certain products need to be marked as discontinued or out of stock. For these products, resetting the <code>stock_level</code> field to NULL helps indicate that the field no longer holds any meaningful value and should be excluded from stock calculations.</p>
<p><strong>Solution:</strong> The <code>null()</code> function can be used within an <code>eval</code> expression to set the <code>stock_level</code> field to NULL for discontinued or out-of-stock products.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index=inventory_data </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| eval stock_level=if(status=&quot;discontinued&quot; OR status=&quot;out_of_stock&quot;, null(), stock_level)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| fields product_id product_name status stock_level</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> command checks if the <code>status</code> field is either &quot;discontinued&quot; or &quot;out_of_stock&quot;.</li>
<li>If the condition is met, the <code>stock_level</code> field is set to NULL using the <code>null()</code> function.</li>
<li>This approach ensures that the <code>stock_level</code> field is cleared for discontinued or out-of-stock products, making it clear that these products should not be considered in stock-related calculations.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="nulliffield1-field2">nullif(&lt;field1&gt;, &lt;field2&gt;)<a href="#nulliffield1-field2" class="hash-link" aria-label="Direct link to nullif(&lt;field1&gt;, &lt;field2&gt;)" title="Direct link to nullif(&lt;field1&gt;, &lt;field2&gt;)">​</a></h2>
<p>This function compares the values in two fields and returns <code>NULL</code> if the value in <code>&lt;field1&gt;</code> is equal to the value in <code>&lt;field2&gt;</code>. Otherwise the function returns the value in <code>&lt;field1&gt;</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-9">Usage<a href="#usage-9" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li>You can use this function with the <code>eval</code> and <code>where</code> commands, and as part of eval expressions.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-9">Use-Case Example<a href="#use-case-example-9" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Handling Redundant Data in User Activity Logs</strong></p>
<p><strong>Problem:</strong> In user activity logs, sometimes the <code>previous_page</code> and <code>current_page</code> fields can have the same value, indicating that the user has refreshed the same page. For better clarity in reports, it&#x27;s useful to set the <code>current_page</code> field to NULL when it matches the <code>previous_page</code>.</p>
<p><strong>Solution:</strong> The <code>nullif()</code> function can be used within an <code>eval</code> expression to set the <code>current_page</code> field to NULL if it is equal to the <code>previous_page</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index=user_activity_logs </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| eval current_page=nullif(current_page, previous_page)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| fields user_id previous_page current_page timestamp</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> command uses the <code>nullif()</code> function to compare the <code>current_page</code> and <code>previous_page</code> fields.</li>
<li>If the values in <code>current_page</code> and <code>previous_page</code> are the same, the <code>current_page</code> field is set to NULL.</li>
<li>This approach helps in identifying and handling page refreshes by the user, making the logs cleaner and more meaningful.</li>
</ol>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="cidrmatchcidr-ip">cidrmatch(&lt;cidr&gt;, &lt;ip&gt;)<a href="#cidrmatchcidr-ip" class="hash-link" aria-label="Direct link to cidrmatch(&lt;cidr&gt;, &lt;ip&gt;)" title="Direct link to cidrmatch(&lt;cidr&gt;, &lt;ip&gt;)">​</a></h2>
<p>This function matches <code>&lt;ip&gt;</code> with the <code>&lt;cidr&gt;</code> and returns <code>true</code> if match is successful; otherwise it returns <code>false</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage-10">Usage<a href="#usage-10" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li><code>&lt;ip&gt;</code> can be a field name or a string literal representing ip address.</li>
<li><code>&lt;cidr&gt;</code> can be a field name or a string literal representing CIDR notation.</li>
<li>You can use this function with eval and where commands.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-example-10">Use-Case Example<a href="#use-case-example-10" class="hash-link" aria-label="Direct link to Use-Case Example" title="Direct link to Use-Case Example">​</a></h3>
<p><strong>Filtering IP Addresses by Subnet</strong></p>
<p><strong>Problem:</strong> In network analysis and security, it&#x27;s crucial to quickly identify whether IP addresses accessing a service fall within a specific subnet. This helps in assessing access patterns and identifying potentially unauthorized or suspicious activities.</p>
<p><strong>Solution:</strong> To efficiently filter IP addresses by subnet, a command can be utilized to analyze the <code>client_ip</code> field in the dataset. This command employs the <code>eval</code> function combined with the <code>cidrmatch</code> function to check if the IP addresses match the CIDR block <code>10.0.0.0/24</code>.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | eval is_subnet=if(cidrmatch(&quot;10.0.0.0/24&quot;, client_ip), &quot;yes&quot;, &quot;no&quot;)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><strong>Explanation:</strong></p>
<ol>
<li>The <code>eval</code> function creates a new field named <code>is_subnet</code>, which indicates whether a <code>client_ip</code> is within the specified subnet.</li>
<li>The <code>cidrmatch</code> function is used to compare each <code>client_ip</code> against the CIDR block <code>10.0.0.0/24</code>. This function:</li>
</ol>
<ul>
<li>Returns <code>true</code> if the <code>client_ip</code> falls within the <code>10.0.0.0/24</code> subnet.</li>
<li>Returns <code>false</code> otherwise.</li>
</ul>
<ol start="3">
<li>Based on the result from <code>cidrmatch</code>, the <code>if</code> function assigns:</li>
</ol>
<ul>
<li><code>&quot;yes&quot;</code> to the <code>is_subnet</code> field if the IP is within the subnet.</li>
<li><code>&quot;no&quot;</code> if the IP is outside the subnet.</li>
</ul>
<p>This method allows for the quick identification of IP addresses within a specific subnet, aiding in network analysis, security monitoring, and ensuring that access patterns are within expected parameters.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/siglens-docs/spl-docs/evaluation-functions/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Overview of SPL eval functions</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/siglens-docs/spl-docs/evaluation-functions/conversion-functions"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Conversion Functions</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#casecondition1-value1-condition2-value2-" class="table-of-contents__link toc-highlight">case(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)</a><ul><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#validatecondition1-value1-condition2-value2-" class="table-of-contents__link toc-highlight">validate(&lt;condition1&gt;, &lt;value1&gt;, &lt;condition2&gt;, &lt;value2&gt; ...)</a><ul><li><a href="#usage-1" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-1" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#coalescevalues" class="table-of-contents__link toc-highlight">coalesce(&lt;values&gt;)</a><ul><li><a href="#usage-2" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-2" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#searchmatchsearch_str" class="table-of-contents__link toc-highlight">searchmatch(&lt;search_str&gt;)</a><ul><li><a href="#usage-3" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-3" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#ifpredicate-true_value-false_value" class="table-of-contents__link toc-highlight">if(&lt;predicate&gt;, &lt;true_value&gt;, &lt;false_value&gt;)</a><ul><li><a href="#usage-4" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-4" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#invalue-list" class="table-of-contents__link toc-highlight">in(&lt;value&gt;, &lt;list&gt;)</a><ul><li><a href="#usage-5" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-5" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#likestr-pattern" class="table-of-contents__link toc-highlight">like(&lt;str&gt;, &lt;pattern&gt;)</a><ul><li><a href="#usage-6" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li><li><a href="#use-case-example-6" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#matchstr-regex" class="table-of-contents__link toc-highlight">match(&lt;str&gt;, &lt;regex&gt;)</a><ul><li><a href="#usage-7" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-7" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#null" class="table-of-contents__link toc-highlight">null()</a><ul><li><a href="#usage-8" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-8" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#nulliffield1-field2" class="table-of-contents__link toc-highlight">nullif(&lt;field1&gt;, &lt;field2&gt;)</a><ul><li><a href="#usage-9" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-9" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li><li><a href="#cidrmatchcidr-ip" class="table-of-contents__link toc-highlight">cidrmatch(&lt;cidr&gt;, &lt;ip&gt;)</a><ul><li><a href="#usage-10" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#use-case-example-10" class="table-of-contents__link toc-highlight">Use-Case Example</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>