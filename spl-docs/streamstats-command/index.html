<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-spl-docs/streamstats-command" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.0.0">
<title data-rh="true">streamstats command | SigLens Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://siglens.github.io/siglens-docs/img/social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://siglens.github.io/siglens-docs/img/social-card.jpg"><meta data-rh="true" property="og:url" content="https://siglens.github.io/siglens-docs/spl-docs/streamstats-command"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="streamstats command | SigLens Docs"><meta data-rh="true" name="description" content="Description"><meta data-rh="true" property="og:description" content="Description"><link data-rh="true" rel="icon" href="/siglens-docs/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://siglens.github.io/siglens-docs/spl-docs/streamstats-command"><link data-rh="true" rel="alternate" href="https://siglens.github.io/siglens-docs/spl-docs/streamstats-command" hreflang="en"><link data-rh="true" rel="alternate" href="https://siglens.github.io/siglens-docs/spl-docs/streamstats-command" hreflang="x-default"><link rel="stylesheet" href="/siglens-docs/assets/css/styles.f7ef957f.css">
<script src="/siglens-docs/assets/js/runtime~main.5ea93ddd.js" defer="defer"></script>
<script src="/siglens-docs/assets/js/main.e0aad576.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/siglens-docs/"><div class="navbar__logo"><img src="/siglens-docs/img/logo.svg" alt="SigLens" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/siglens-docs/img/logo.svg" alt="SigLens" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SigLens Docs</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/siglens-docs/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="http://playground.siglens.com:5122/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Playground<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/siglens/siglens" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/">Introduction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/key-concepts">Key Concepts</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/installation">Installation</a><button aria-label="Expand sidebar category &#x27;Installation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/log-ingestion">Log Ingestion</a><button aria-label="Expand sidebar category &#x27;Log Ingestion&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/metric-ingestion">Metric Ingestion</a><button aria-label="Expand sidebar category &#x27;Metric Ingestion&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/instrumentation-for-traces">Instrumentation for Traces</a><button aria-label="Expand sidebar category &#x27;Instrumentation for Traces&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/siglens-docs/category/migration">Migration</a><button aria-label="Expand sidebar category &#x27;Migration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/siglens-docs/category/splunk-commands">Splunk Commands</a><button aria-label="Collapse sidebar category &#x27;Splunk Commands&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/splunk-commands">Overview of Supported SPL Commands</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/common-usecases">Common Use-Cases</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/bin-command">bin command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/dedup-command">dedup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/eval-command">eval command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/extract-command">extract command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/fields-command">fields command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/fillnull-command">fillnull</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/gentimes-command">gentimes command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/head-command">head command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/inputlookup-command">inputlookup command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/makemv-command">makemv</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/rare-command">rare Command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/regex-command">regex command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/rename-command">rename Command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/rex-command">rex</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/search-command">search command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/sort-command">sort Command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/stats-command">stats Command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/siglens-docs/spl-docs/streamstats-command">streamstats command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/tail-command">tail command</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/time-modifiers">Time Modifiers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/timechart-command">timechart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/top-command">top</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/transaction-command">Transaction</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/siglens-docs/spl-docs/where-command">where command</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/siglens-docs/category/evaluation-functions">Evaluation Functions</a><button aria-label="Expand sidebar category &#x27;Evaluation Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/siglens-docs/category/aggregate-functions">Aggregate Functions</a><button aria-label="Expand sidebar category &#x27;Aggregate Functions&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/siglens-docs/grafana-integrations/prometheus-data-source">Grafana Integrations</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/elasticsearch-apis">Elasticsearch APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/promql-apis">PromQL APIs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/siglens-metrics">SigLens Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/searching-logs">Searching Logs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/log-query-builder">Log Query Builder</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/dashboards">Dashboards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/saved-searches">Saved Queries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/alerts">Alerts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/minion-searches">Minion Searches</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/cluster-health">Cluster Health</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/retention">Cluster Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/configuration">SigLens Configuration Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/oss-vs-enterprise-features">SigLens: Open Source vs Enterprise Edition</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/contribution-guidelines">Contribution Guidelines</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/siglens-docs/community">Community</a></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/siglens-docs/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/siglens-docs/category/splunk-commands"><span itemprop="name">Splunk Commands</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">streamstats command</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>streamstats command</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="description">Description<a href="#description" class="hash-link" aria-label="Direct link to Description" title="Direct link to Description">​</a></h2>
<p>The <code>streamstats</code> command adds cumulative statistics to search results in real-time. It computes statistics for each event as it is encountered. For instance, you can determine the running total, average, or any other aggregate for a specific field. These aggregates are derived from the values in the specified field for all events processed up to the current one.</p>
<p>As each event is processed by the <code>streamstats</code> command, a field is added to that event or result, representing the cumulative aggregate of all preceding events within the window. This field&#x27;s value updates with each event or result as the composition of events in the window or result set changes. Essentially, the <code>streamstats</code> command generates a running aggregate that is applied to each event.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="syntax">Syntax<a href="#syntax" class="hash-link" aria-label="Direct link to Syntax" title="Direct link to Syntax">​</a></h2>
<p>Required syntax is in <strong>bold</strong>.</p>
<p><strong>streamstats</strong><br>
<!-- -->[reset_on_change=&lt;bool&gt;]<br>
<!-- -->[reset_before=(&lt;eval-expression&gt;)]<br>
<!-- -->[reset_after=(&lt;eval-expression&gt;)]<br>
<!-- -->[current=&lt;bool&gt;]<br>
<!-- -->[window=&lt;int&gt;]<br>
<!-- -->[time_window=&lt;span-length&gt;]<br>
<!-- -->[global=&lt;bool&gt;]<br>
<!-- -->[allnum=&lt;bool&gt;]<br>
<strong>&lt;stats-agg-term&gt;...</strong><br>
<!-- -->[&lt;by-clause&gt;]</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="required-arguments">Required Arguments<a href="#required-arguments" class="hash-link" aria-label="Direct link to Required Arguments" title="Direct link to Required Arguments">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stats-agg-term">stats-agg-term<a href="#stats-agg-term" class="hash-link" aria-label="Direct link to stats-agg-term" title="Direct link to stats-agg-term">​</a></h4>
<p><strong>Syntax:</strong> <code>&lt;stats-func&gt;(&lt;input-field-name&gt;) [AS &lt;output-field-name&gt;]</code><br>
<strong>Description:</strong> <br>
<!-- -->A statistical aggregation function. This function can be applied to an <code>eval</code> expression, or to a single field.<br>
<!-- -->Use the <code>AS</code> clause to assign the result to a new field with a name you choose.<br>
<!-- -->Multiple <code>stats-agg-term</code> clauses can be used to calculate different statistics in a single <code>streamstats</code> command.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="optional-arguments">Optional Arguments<a href="#optional-arguments" class="hash-link" aria-label="Direct link to Optional Arguments" title="Direct link to Optional Arguments">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="by-clause">by-clause<a href="#by-clause" class="hash-link" aria-label="Direct link to by-clause" title="Direct link to by-clause">​</a></h4>
<p><strong>Syntax:</strong> <code>BY &lt;field-list&gt;</code><br>
<strong>Description:</strong> <br>
<!-- -->Specify one or more fields to group by.<br>
<!-- -->Wildcard characters cannot be used; each field must be named individually.<br>
<!-- -->The <code>BY</code> clause produces running statistics for each event based on the distinct values in the specified fields.<br>
<!-- -->Without a <code>BY</code> clause, the <code>streamstats</code> command returns running statistics that consider all events in the window up to the current event.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="current">current<a href="#current" class="hash-link" aria-label="Direct link to current" title="Direct link to current">​</a></h4>
<p><strong>Syntax:</strong> current=<code>&lt;boolean&gt;</code><br>
<strong>Description:</strong> <br>
<!-- -->If <code>true</code>, the search includes the current event in the statistical calculations.<br>
<!-- -->If <code>false</code>, the search performs statistical calculations without including the current event.<br>
<strong>Default:</strong> <code>true</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="global">global<a href="#global" class="hash-link" aria-label="Direct link to global" title="Direct link to global">​</a></h4>
<p><strong>Syntax:</strong> global=<code>&lt;boolean&gt;</code><br>
<strong>Description:</strong><br>
<!-- -->This option is used only when the <code>window</code> argument is set.<br>
<!-- -->If <code>true</code>, a single global window is used for statistical calculations.<br>
<!-- -->If <code>false</code>, separate windows are used for statistical calculations for each group of values specified in the <code>BY</code> clause.<br>
<strong>Default:</strong> <code>true</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reset_after">reset_after<a href="#reset_after" class="hash-link" aria-label="Direct link to reset_after" title="Direct link to reset_after">​</a></h4>
<p><strong>Syntax:</strong> reset_after=(<code>&lt;boolean-expression&gt;</code>)<br>
<strong>Description:</strong><br>
<!-- -->If the <code>boolean-expression</code> is evaluated to <code>true</code>, all accumulated statistics are reset after the <code>streamstats</code> calculations are produced for an event.<br>
<!-- -->The <code>boolean-expression</code> must return either <code>true</code> or <code>false</code>.<br>
<!-- -->When used with the <code>window</code> argument, the window is also reset when the accumulated statistics are reset.<br>
<strong>Default:</strong> <code>false</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reset_before">reset_before<a href="#reset_before" class="hash-link" aria-label="Direct link to reset_before" title="Direct link to reset_before">​</a></h4>
<p><strong>Syntax:</strong> reset_before=(<code>&lt;boolean-expression&gt;</code>)<br>
<strong>Description:</strong><br>
<!-- -->If the <code>boolean-expression</code> is evaluated to <code>true</code>, all accumulated statistics are reset before the <code>streamstats</code> calculations are produced for an event.<br>
<!-- -->The <code>boolean-expression</code> must return either <code>true</code> or <code>false</code>.<br>
<!-- -->When used with the <code>window</code> argument, the window is also reset when the accumulated statistics are reset.<br>
<strong>Default:</strong> <code>false</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="reset_on_change">reset_on_change<a href="#reset_on_change" class="hash-link" aria-label="Direct link to reset_on_change" title="Direct link to reset_on_change">​</a></h4>
<p><strong>Syntax:</strong> reset_on_change=<code>&lt;boolean&gt;</code><br>
<strong>Description:</strong> <br>
<!-- -->If <code>true</code>, all accumulated statistics are reset when the group-by fields change, as if no previous events have been processed.<br>
<!-- -->When used with the <code>window</code> argument, the window is also reset when the accumulated statistics are reset. Refer to the Usage section for more details.<br>
<strong>Default:</strong> <code>false</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="time_window">time_window<a href="#time_window" class="hash-link" aria-label="Direct link to time_window" title="Direct link to time_window">​</a></h4>
<p><strong>Syntax:</strong> time_window=<code>&lt;span-length&gt;</code><br>
<strong>Description:</strong> <br>
<!-- -->Calculations are performed based on a time-based window, determined by the <code>timestamp</code> of the current event.<br>
<!-- -->This option requires the results to be sorted in either increasing or decreasing order of the <code>timestamp</code> field.<br>
<!-- -->The <code>global</code> and <code>current</code> options cannot be set to <code>false</code> when using this option.</p>
<p><strong>For example:</strong><br>
<code>... | streamstats time_window=10m avg(latency)</code><br>
<!-- -->If the <code>timestamp</code> is sorted in increasing order, the <code>avg</code> of <code>latency</code> is calculated based on the events in the last 10 minutes. If sorted in decreasing order, the <code>avg</code> is based on the events in the next 10 minutes.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="span-length">&lt;span-length&gt;<a href="#span-length" class="hash-link" aria-label="Direct link to &lt;span-length&gt;" title="Direct link to &lt;span-length&gt;">​</a></h4>
<p><strong>Syntax:</strong> <code>&lt;int&gt;&lt;timescale&gt;</code><br>
<strong>Description:</strong> <br>
<code>&lt;span-length&gt;</code> specifies the duration of the window.<br>
<code>&lt;int&gt;</code> is a positive integer that defines the magnitude of the time unit specified by <code>timescale</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="timescale">&lt;timescale&gt;<a href="#timescale" class="hash-link" aria-label="Direct link to &lt;timescale&gt;" title="Direct link to &lt;timescale&gt;">​</a></h4>
<p><strong>Syntax:</strong> <code>&lt;second&gt;</code>, <code>&lt;minute&gt;</code>, <code>&lt;hour&gt;</code>, <code>&lt;day&gt;</code>, <code>&lt;week&gt;</code>, <code>&lt;month&gt;</code>, <code>&lt;quarter&gt;</code> or <code>&lt;year&gt;</code><br>
<strong>Description:</strong> <br>
<code>&lt;timescale&gt;</code> is a <code>&lt;string&gt;</code> that specifies the unit of time.<br>
<!-- -->For <code>&lt;month&gt;</code>, the only permissible <code>&lt;int&gt;</code> values are <code>1, 2, 3, 4, 6, 12</code>.<br>
<!-- -->For <code>&lt;quarter&gt;</code>, the only permissible <code>&lt;int&gt;</code> values are <code>1, 2, 4</code>.</p>
<table><thead><tr><th><strong>Unit</strong></th><th><strong>Strings used to specify Unit</strong></th></tr></thead><tbody><tr><td><code>&lt;second&gt;</code></td><td>seconds, second, secs, sec, s</td></tr><tr><td><code>&lt;minute&gt;</code></td><td>minutes, minute, mins, min, m</td></tr><tr><td><code>&lt;hour&gt;</code></td><td>hours, hour, hrs, hr, h</td></tr><tr><td><code>&lt;day&gt;</code></td><td>days, day, d</td></tr><tr><td><code>&lt;week&gt;</code></td><td>weeks, week, w</td></tr><tr><td><code>&lt;month&gt;</code></td><td>months, month, mon</td></tr><tr><td><code>&lt;quarter&gt;</code></td><td>quarters, quarter, qtrs, qtr, q</td></tr><tr><td><code>&lt;year&gt;</code></td><td>years, year, yrs, yr, y</td></tr></tbody></table>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="window">window<a href="#window" class="hash-link" aria-label="Direct link to window" title="Direct link to window">​</a></h4>
<p><strong>Syntax:</strong> window=<code>&lt;int&gt;</code><br>
<strong>Description:</strong> <br>
<!-- -->Specifies the number of events to include in the statistical calculations.<br>
<!-- -->A window value of 0 means all previous and current events are used.<br>
<!-- -->When both <code>window</code> and <code>time_window</code> options are specified, only events that fall within the <code>time_window</code> and do not exceed the <code>window</code> size will be used for calculations.<br>
<strong>Default:</strong> 0</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="stats-func">stats-func<a href="#stats-func" class="hash-link" aria-label="Direct link to stats-func" title="Direct link to stats-func">​</a></h4>
<p><strong>Syntax:</strong> The syntax depends on the function that you use. Refer to the table below.<br>
<strong>Description:</strong><br>
<!-- -->Statistical functions that you can use with the <code>streamstats</code> command. Each time you invoke the <code>streamstats</code> command, you can use one or more of these functions. However, you can only use one BY clause.</p>
<p>The following table lists the supported functions by type of function. Use the links in the table to see descriptions and examples for each function</p>
<table><thead><tr><th>Type of function</th><th>Supported functions</th></tr></thead><tbody><tr><td><a href="/siglens-docs/spl-docs/aggregate-functions/agg-functions">Aggregate functions</a></td><td><code>avg()</code>, <code>min()</code>, <code>max()</code>, <code>range()</code>, <code>sum()</code>, <code>count()</code>, <code>distinct_count()</code></td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reset_on_change-1">reset_on_change<a href="#reset_on_change-1" class="hash-link" aria-label="Direct link to reset_on_change" title="Direct link to reset_on_change">​</a></h3>
<p>The following command calculates a running <code>count</code> on hobby and resets the <code>count</code> when the hobby changes.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | streamstats reset_on_change=true count(hobby) AS hobby_count BY Hobby</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output of this command for sample data would look as follows:</p>
<table><thead><tr><th><strong>hobby</strong></th><th><strong>hobby_count</strong></th></tr></thead><tbody><tr><td>Swimming</td><td>1</td></tr><tr><td>Reading</td><td>1</td></tr><tr><td>Reading</td><td>2</td></tr><tr><td>Hiking</td><td>1</td></tr><tr><td>Swimming</td><td>1</td></tr><tr><td>Swimming</td><td>2</td></tr><tr><td>Swimming</td><td>3</td></tr><tr><td>Reading</td><td>1</td></tr><tr><td>Hiking</td><td>1</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reset_after-1">reset_after<a href="#reset_after-1" class="hash-link" aria-label="Direct link to reset_after" title="Direct link to reset_after">​</a></h3>
<p>The following command calculates the running <code>count</code> on the hobby and resets the <code>count</code> when the hobby <code>Swimming</code> is observed, after including the current event.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | streamstats reset_after=(hobby=&quot;Swimming&quot;) count(hobby) AS hobby_count</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output of this command for sample data would look as follows:</p>
<table><thead><tr><th><strong>hobby</strong></th><th><strong>hobby_count</strong></th></tr></thead><tbody><tr><td>Reading</td><td>1</td></tr><tr><td>Reading</td><td>2</td></tr><tr><td>Painting</td><td>3</td></tr><tr><td>Hiking</td><td>4</td></tr><tr><td>Hiking</td><td>5</td></tr><tr><td>Swimming</td><td>6</td></tr><tr><td>Reading</td><td>1</td></tr><tr><td>Hiking</td><td>2</td></tr><tr><td>Acting</td><td>3</td></tr><tr><td>Acting</td><td>4</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reset_before-1">reset_before<a href="#reset_before-1" class="hash-link" aria-label="Direct link to reset_before" title="Direct link to reset_before">​</a></h3>
<p>The following command calculates the running <code>count</code> on the hobby and resets the <code>count</code> when the hobby <code>Swimming</code> is observed, before including the current event.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">... | streamstats reset_before=(hobby=&quot;Swimming&quot;) count(hobby) AS hobby_count</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>The output of this command for sample data would look as follows:</p>
<table><thead><tr><th><strong>hobby</strong></th><th><strong>hobby_count</strong></th></tr></thead><tbody><tr><td>Reading</td><td>1</td></tr><tr><td>Reading</td><td>2</td></tr><tr><td>Painting</td><td>3</td></tr><tr><td>Hiking</td><td>4</td></tr><tr><td>Hiking</td><td>5</td></tr><tr><td>Swimming</td><td>1</td></tr><tr><td>Reading</td><td>2</td></tr><tr><td>Hiking</td><td>3</td></tr><tr><td>Acting</td><td>4</td></tr><tr><td>Acting</td><td>5</td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="use-case-examples">Use-Case Examples<a href="#use-case-examples" class="hash-link" aria-label="Direct link to Use-Case Examples" title="Direct link to Use-Case Examples">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="monitoring-web-server-performance-in-real-time">Monitoring Web Server Performance in Real-Time<a href="#monitoring-web-server-performance-in-real-time" class="hash-link" aria-label="Direct link to Monitoring Web Server Performance in Real-Time" title="Direct link to Monitoring Web Server Performance in Real-Time">​</a></h3>
<p><strong>Problem:</strong> A web operations team needs to monitor their web server&#x27;s performance in real-time, specifically focusing on response times. They want to identify trends and potential issues by looking at a moving average of response times over short periods, rather than just individual data points which might be affected by momentary spikes.</p>
<p><strong>Solution:</strong> Use the <code>streamstats</code> command to calculate a 5-minute moving average of response times:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index=webserver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| sort timestamp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| streamstats time_window=5m avg(response_time) AS avg_response_time</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation">Explanation<a href="#explanation" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<ul>
<li><code>sort timestamp</code> sorts the events in increasing order of timestamp.</li>
<li>The <code>time_window=5m</code> parameter tells <code>streamstats</code> to look at the preceding 5 minutes of data for each event.</li>
<li><code>avg(response_time)</code> calculates the average of the <code>response_time</code> field within the specified time window.</li>
<li><code>AS avg_response_time</code> creates a new field with this name for each event, containing the calculated average.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="detecting-potential-brute-force-attacks-by-monitoring-failed-login-attempts">Detecting Potential Brute Force Attacks by Monitoring Failed Login Attempts<a href="#detecting-potential-brute-force-attacks-by-monitoring-failed-login-attempts" class="hash-link" aria-label="Direct link to Detecting Potential Brute Force Attacks by Monitoring Failed Login Attempts" title="Direct link to Detecting Potential Brute Force Attacks by Monitoring Failed Login Attempts">​</a></h3>
<p><strong>Problem:</strong> You are a system security analyst tasked with monitoring login attempts across multiple servers. You want to identify when there are multiple failed login attempts for a single user account within a short time frame, which could indicate a brute force attack. After detecting these patterns, you want to perform further analysis to summarize the findings.</p>
<p><strong>Solution:</strong> Use the <code>streamstats</code> command to detect multiple failed login attempts and summarize the findings.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index=auth_logs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| streamstats window=5 global=false count(eval(status=&quot;failed&quot; AND reason=&quot;invalid password&quot;)) as failed_login_count by user, src_ip </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| where failed_login_count &gt;= 3 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| stats avg(failed_login_count) as avg_failed_attempts, max(failed_login_count) as max_failed_attempts, min(failed_login_count) as min_failed_attempts by user, src_ip</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-1">Explanation<a href="#explanation-1" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<ul>
<li><code>streamstats window=5 global=false sum(eval(status=&quot;failed&quot; AND reason=&quot;invalid password&quot;)) as failed_login_count by user, src_ip</code> uses streamstats to calculate the sum of failed login attempts within the last 5 events for each combination of user and source IP.<!-- -->
<ul>
<li><code>window=5</code> specifies that we&#x27;re looking at the last 5 login attempts.</li>
<li><code>global=false</code> ensures that these calculations are done separately for each user and source IP combination.</li>
<li><code>by user, src_ip</code> groups the calculations by each user and source IP address.</li>
<li><code>count(eval(status=&quot;failed&quot; AND reason=&quot;invalid password&quot;))</code> counts the number of events where the login status is <code>failed</code> and the reason is <code>invalid password</code>.</li>
</ul>
</li>
<li><code>where failed_login_count &gt;= 3</code> filters the results to show only events where there were 3 or more failed login attempts within the last 5 attempts for a user from a specific IP.</li>
<li><code>stats avg(failed_login_count) as avg_failed_attempts, max(failed_login_count) as max_failed_attempts, min(failed_login_count) as min_failed_attempts by user, src_ip</code> summarizes the findings by calculating:<!-- -->
<ul>
<li>avg_failed_attempts shows the average number of failed login attempts within the window.</li>
<li>max_failed_attempts shows the maximum number of failed login attempts within the window.</li>
<li>min_failed_attempts shows the minimum number of failed login attempts within the window.</li>
</ul>
</li>
<li><code>by user, src_ip</code> groups the summary statistics by user and source IP.</li>
</ul>
<p>This approach provides a comprehensive view of potential brute force attacks, allowing security teams to quickly identify and respond to threats. By combining streamstats with stats, we can efficiently detect patterns of failed login attempts and summarize the findings using simple statistical functions.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="identifying-anomalous-application-performance-patterns">Identifying Anomalous Application Performance Patterns<a href="#identifying-anomalous-application-performance-patterns" class="hash-link" aria-label="Direct link to Identifying Anomalous Application Performance Patterns" title="Direct link to Identifying Anomalous Application Performance Patterns">​</a></h3>
<p><strong>Problem:</strong> A system administrator needs to identify applications with unusual performance patterns, focusing on high latency volatility, significant CPU time deviations from the average, and above-average request volumes. This information can be used to spot potential performance issues, resource constraints, or usage anomalies that require immediate attention or further investigation.</p>
<p><strong>Solution:</strong> Use the <code>streamstats</code> command to calculate key metrics over a 1-hour window. By applying various statistical functions, you can identify applications with high latency volatility, significant CPU time deviations, and above-average request volumes, thereby uncovering unusual performance patterns.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">index=app_performance</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| eval cpu_utilization = cpu_time / total_time * 100 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| streamstats time_window=1h </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min(response_time) AS min_response_time,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    max(response_time) AS max_response_time,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(cpu_time) AS avg_cpu_time,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(memory_usage) AS avg_memory_usage,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg(requests) AS avg_requests,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    BY app_name </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| eval latency_volatility = (max_response_time - min_response_time) / min_response_time * 100 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| eval relative_cpu_load = (cpu_time / avg_cpu_time - 1) * 100 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| where </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    requests &gt; avg_requests * 1.5 </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    AND (latency_volatility &gt; 50 OR abs(relative_cpu_load) &gt; 25) </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| fields _time, app_name, response_time, cpu_time, memory_usage, avg_memory_usage, requests, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    min_response_time, max_response_time, latency_volatility, </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    avg_cpu_time, avg_requests, relative_cpu_load, cpu_utilization </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">| sort -latency_volatility</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="explanation-2">Explanation<a href="#explanation-2" class="hash-link" aria-label="Direct link to Explanation" title="Direct link to Explanation">​</a></h4>
<ul>
<li><code>streamstats time_window=1h</code> calculates metrics over a 1-hour window for each application.</li>
<li><strong>Metrics Calculation:</strong>
<ul>
<li><code>min(response_time) AS min_response_time</code> finds the minimum response time in the 1-hour period.</li>
<li><code>max(response_time) AS max_response_time</code> finds the maximum response time in the 1-hour period.</li>
<li><code>avg(cpu_time) AS avg_cpu_time</code> calculates the average CPU time over the 1-hour period.</li>
<li><code>avg(memory_usage) AS avg_memory_usage</code> calculates the average memory usage over the 1-hour period.</li>
<li><code>avg(requests) AS avg_requests</code> calculates the average number of requests over the 1-hour period.</li>
</ul>
</li>
<li><code>eval latency_volatility = (max_response_time - min_response_time) / min_response_time * 100</code> calculates the latency volatility as a percentage.</li>
<li><code>eval relative_cpu_load = (cpu_time / avg_cpu_time - 1) * 100</code> calculates the relative CPU load as a percentage.</li>
<li><code>where requests &gt; avg_requests * 1.5 AND (latency_volatility &gt; 50 OR abs(relative_cpu_load) &gt; 25)</code> filters applications with above-average request volumes and either high latency volatility or significant CPU load deviations.</li>
<li><code>fields _time, app_name, response_time, cpu_time, memory_usage, avg_memory_usage, requests, min_response_time, max_response_time, latency_volatility, avg_cpu_time, avg_requests, relative_cpu_load, cpu_utilization</code> selects the relevant fields for the final output.</li>
<li><code>sort -latency_volatility</code> sorts the results by latency volatility in descending order.</li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/siglens-docs/spl-docs/stats-command"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">stats Command</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/siglens-docs/spl-docs/tail-command"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">tail command</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#description" class="table-of-contents__link toc-highlight">Description</a></li><li><a href="#syntax" class="table-of-contents__link toc-highlight">Syntax</a><ul><li><a href="#required-arguments" class="table-of-contents__link toc-highlight">Required Arguments</a></li><li><a href="#optional-arguments" class="table-of-contents__link toc-highlight">Optional Arguments</a></li><li><a href="#usage" class="table-of-contents__link toc-highlight">Usage</a></li><li><a href="#reset_on_change-1" class="table-of-contents__link toc-highlight">reset_on_change</a></li><li><a href="#reset_after-1" class="table-of-contents__link toc-highlight">reset_after</a></li><li><a href="#reset_before-1" class="table-of-contents__link toc-highlight">reset_before</a></li></ul></li><li><a href="#use-case-examples" class="table-of-contents__link toc-highlight">Use-Case Examples</a><ul><li><a href="#monitoring-web-server-performance-in-real-time" class="table-of-contents__link toc-highlight">Monitoring Web Server Performance in Real-Time</a></li><li><a href="#detecting-potential-brute-force-attacks-by-monitoring-failed-login-attempts" class="table-of-contents__link toc-highlight">Detecting Potential Brute Force Attacks by Monitoring Failed Login Attempts</a></li><li><a href="#identifying-anomalous-application-performance-patterns" class="table-of-contents__link toc-highlight">Identifying Anomalous Application Performance Patterns</a></li></ul></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>